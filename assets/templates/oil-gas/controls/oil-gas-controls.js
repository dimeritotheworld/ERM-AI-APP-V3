/**
 * Oil & Gas - Control Templates
 * Dimeri ERM Template Library
 */
if (!window.ERM_TEMPLATES) window.ERM_TEMPLATES = {};
if (!window.ERM_TEMPLATES.oilGas) window.ERM_TEMPLATES.oilGas = {};
if (!window.ERM_TEMPLATES.oilGas.controls) window.ERM_TEMPLATES.oilGas.controls = {};

window.ERM_TEMPLATES.oilGas.controls.wellControl = [
  {
    id: "ctrl-well-control-barriers",
    titles: [
      "Well Control Barriers",
      "BOP Management Program",
      "Well Barrier Policy",
      "Well Control Program",
      "Two Barrier Philosophy",
      "Primary and Secondary Well Barriers",
      "Well Control Equipment Management",
      "Barrier Verification Program",
    ],
    descriptions: [
      "Multiple independent well control barriers including BOP systems, mud weight management, and real-time monitoring to prevent and detect kicks and maintain well integrity throughout the well lifecycle.",
      "Comprehensive well barrier policy requiring two independent barriers at all times during drilling, completion, and workover operations with regular barrier verification.",
      "Well control program with barrier philosophy, BOP testing requirements, well control training, emergency response procedures, and management of change controls.",
      "Blowout preventer management ensuring function testing, maintenance, and certification to industry standards including API RP 53 and regulatory requirements.",
      "Real-time well monitoring with automated kick detection, early warning systems, and decision support tools enabling rapid well control response.",
    ],
    keywords: [
      "well control",
      "BOP",
      "barrier",
      "kick",
      "mud weight",
      "well integrity",
      "two barrier",
      "annular",
      "rams",
      "shear",
      "accumulator",
      "drilling",
    ],
    type: "preventive",
    category: "physical",
    owners: {
      primary: ["Drilling Manager", "Well Control Specialist", "VP Drilling"],
      secondary: ["Drilling Superintendent", "HSE Manager", "Rig Manager"],
    },
    frequency: "continuous",
    department: "drilling",
    mitigatesRiskCategories: ["well-control", "drilling-operations"],
  },
  {
    id: "ctrl-well-control-training",
    titles: [
      "Well Control Training Program",
      "IWCF/IADC Certification",
      "Well Control Competency",
      "Driller Training Program",
      "Well Control Simulator Training",
      "Crew Well Control Drills",
      "Competency Assessment",
      "Well Control Awareness",
    ],
    descriptions: [
      "Comprehensive well control training program ensuring all drilling personnel maintain current IWCF or IADC certifications with regular refresher training and competency assessment.",
      "Simulator-based well control training providing realistic scenarios for kick detection, shut-in procedures, and well kill operations under various conditions.",
      "Well control drills conducted regularly on all rigs to test crew response, verify equipment function, and identify areas for improvement.",
      "Competency assessment program verifying well control knowledge and skills for all rig personnel with additional training for identified gaps.",
      "Specialized well control training for high-pressure, deepwater, or sour operations addressing unique challenges and response requirements.",
    ],
    keywords: [
      "training",
      "IWCF",
      "IADC",
      "certification",
      "competency",
      "simulator",
      "drills",
      "well control",
      "awareness",
      "kick",
      "shut-in",
    ],
    type: "preventive",
    category: "manual",
    owners: {
      primary: ["Training Manager", "Well Control Specialist", "Drilling Manager"],
      secondary: ["Drilling Superintendent", "Toolpusher", "HSE Manager"],
    },
    frequency: "scheduled",
    department: "drilling",
    mitigatesRiskCategories: ["well-control", "drilling-operations"],
  },
  {
    id: "ctrl-well-design-review",
    titles: [
      "Well Design Review",
      "Well Engineering Review",
      "Casing Design Verification",
      "Pore Pressure Analysis",
      "Well Program Review",
      "Independent Well Review",
      "Technical Authority Approval",
      "Design Basis Review",
    ],
    descriptions: [
      "Formal well design review process ensuring casing, cement, mud, and barrier designs are adequate for anticipated pressures, temperatures, and conditions.",
      "Pore pressure prediction and verification throughout drilling with mud weight windows defined and updated based on drilling data and measurements.",
      "Independent technical review of well design by qualified engineers not directly involved in the design, providing additional assurance.",
      "Technical authority approval process requiring sign-off on well designs by designated experts with authority to reject inadequate designs.",
      "Design basis review comparing planned conditions against actual encountered conditions with lessons learned captured for future wells.",
    ],
    keywords: [
      "well design",
      "review",
      "casing",
      "cement",
      "pore pressure",
      "engineering",
      "independent",
      "technical authority",
      "verification",
      "approval",
    ],
    type: "preventive",
    category: "policy",
    owners: {
      primary: ["Well Engineering Manager", "Drilling Manager", "Technical Authority"],
      secondary: ["Drilling Engineer", "Completions Engineer", "Geologist"],
    },
    frequency: "per-well",
    department: "drilling",
    mitigatesRiskCategories: ["well-control", "drilling-operations", "well-integrity"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.processSafety = [
  {
    id: "ctrl-process-safety-management",
    titles: [
      "Process Safety Management",
      "Safety Critical Element Management",
      "Barrier Management System",
      "PSM Program",
      "Major Accident Prevention",
      "Performance Standards",
      "SCE Verification",
      "Bow-Tie Risk Management",
    ],
    descriptions: [
      "Comprehensive process safety management program including hazard identification, risk assessment, barrier management, and performance monitoring aligned with API RP 75 and OSHA PSM requirements.",
      "Safety critical element management ensuring barriers are identified, maintained, tested, and verified to prevent major accident hazards.",
      "Bow-tie risk management approach identifying threats, consequences, and barriers with ongoing verification of barrier effectiveness.",
      "Performance standards defined for all safety critical elements specifying required function, integrity, and reliability.",
      "Regular verification and assurance activities confirming safety critical elements are in place and functioning as designed.",
    ],
    keywords: [
      "process safety",
      "PSM",
      "barrier",
      "SCE",
      "major accident",
      "LOPC",
      "bow-tie",
      "performance standards",
      "verification",
      "API RP 75",
    ],
    type: "preventive",
    category: "policy",
    owners: {
      primary: ["Process Safety Manager", "Operations Manager", "HSE Director"],
      secondary: ["HSE Manager", "Integrity Manager", "Operations Superintendent"],
    },
    frequency: "continuous",
    department: "hse",
    mitigatesRiskCategories: ["process-safety", "major-accident-hazard"],
  },
  {
    id: "ctrl-mechanical-integrity",
    titles: [
      "Mechanical Integrity Program",
      "Equipment Inspection Program",
      "Pressure Vessel Inspection",
      "Piping Inspection",
      "Corrosion Management",
      "Asset Integrity Management",
      "RBI Program",
      "Thickness Monitoring",
    ],
    descriptions: [
      "Comprehensive mechanical integrity program ensuring pressure-containing equipment is inspected, maintained, and replaced before failure.",
      "Risk-based inspection program optimizing inspection activities based on consequence and likelihood of failure for each equipment item.",
      "Corrosion management program including monitoring, chemical treatment, and material selection to manage corrosion threats.",
      "Pressure vessel and piping inspection per API 510, API 570, and applicable codes with tracking and trending of inspection findings.",
      "Thickness monitoring program tracking wall loss over time and projecting remaining life for corrosion-affected equipment.",
    ],
    keywords: [
      "mechanical integrity",
      "inspection",
      "corrosion",
      "pressure vessel",
      "piping",
      "RBI",
      "API 510",
      "API 570",
      "thickness",
      "fitness for service",
    ],
    type: "detective",
    category: "automated",
    owners: {
      primary: ["Integrity Manager", "Maintenance Manager", "Reliability Engineer"],
      secondary: ["Inspector", "Corrosion Engineer", "Process Safety Manager"],
    },
    frequency: "scheduled",
    department: "maintenance",
    mitigatesRiskCategories: ["process-safety", "mechanical-integrity", "asset-integrity"],
  },
  {
    id: "ctrl-management-of-change",
    titles: [
      "Management of Change",
      "MOC Program",
      "Change Control",
      "Technical Change Management",
      "Modification Control",
      "MOC Review Process",
      "Pre-Startup Safety Review",
      "PSSR",
    ],
    descriptions: [
      "Formal management of change program ensuring all changes to facilities, processes, and procedures are reviewed for safety impact before implementation.",
      "MOC review process requiring hazard evaluation, risk assessment, and approval by designated authorities for all non-replacement-in-kind changes.",
      "Pre-startup safety review confirming all MOC requirements are complete, personnel are trained, and systems are ready before introducing changes.",
      "Technical change management for modifications to process equipment, control systems, and safety systems with engineering review and approval.",
      "Temporary change management with defined duration, monitoring requirements, and conversion or removal deadlines.",
    ],
    keywords: [
      "management of change",
      "MOC",
      "change control",
      "modification",
      "PSSR",
      "pre-startup",
      "safety review",
      "hazard evaluation",
      "approval",
      "temporary change",
    ],
    type: "preventive",
    category: "policy",
    owners: {
      primary: ["Operations Manager", "Process Safety Manager", "Engineering Manager"],
      secondary: ["MOC Coordinator", "Process Engineer", "Safety Advisor"],
    },
    frequency: "per-change",
    department: "operations",
    mitigatesRiskCategories: ["process-safety", "change-management"],
  },
  {
    id: "ctrl-permit-to-work",
    titles: [
      "Permit to Work System",
      "Work Authorization",
      "Safe Work Permits",
      "PTW Program",
      "Job Safety Analysis",
      "Isolation Management",
      "SIMOPS Management",
      "Concurrent Operations Control",
    ],
    descriptions: [
      "Formal permit to work system controlling high-risk activities including hot work, confined space entry, working at height, excavation, and electrical isolation.",
      "Work authorization program ensuring hazards are identified, controls implemented, and approvals obtained before high-risk work commences.",
      "Isolation management including energy isolation, verification, and lock-out/tag-out procedures for maintenance and construction activities.",
      "SIMOPS (simultaneous operations) management controlling interactions between concurrent activities to prevent conflicts and escalation.",
      "Job safety analysis required for permitted work identifying task steps, hazards, and controls with crew briefing and acknowledgment.",
    ],
    keywords: [
      "permit",
      "PTW",
      "authorization",
      "isolation",
      "confined space",
      "hot work",
      "LOTO",
      "JSA",
      "SIMOPS",
      "concurrent operations",
    ],
    type: "preventive",
    category: "manual",
    owners: {
      primary: ["Operations Supervisor", "HSE Manager", "Area Authority"],
      secondary: ["Permit Coordinator", "Safety Advisor", "Maintenance Supervisor"],
    },
    frequency: "per-activity",
    department: "operations",
    mitigatesRiskCategories: ["personal-safety", "process-safety", "work-control"],
  },
  {
    id: "ctrl-fire-gas-detection",
    titles: [
      "Fire and Gas Detection System",
      "F&G System",
      "Hydrocarbon Detection",
      "Fire Detection",
      "Emergency Shutdown System",
      "ESD System",
      "Safety Instrumented System",
      "SIS",
    ],
    descriptions: [
      "Fire and gas detection system providing continuous monitoring for hydrocarbon releases and fires with alarms and automatic response actions.",
      "Emergency shutdown system designed to bring facilities to a safe state upon detection of hazardous conditions or operator initiation.",
      "Safety instrumented systems providing independent layers of protection against specific hazard scenarios with defined safety integrity levels.",
      "Regular testing and verification of fire and gas detection coverage, functionality, and response including executive actions.",
      "Integration of detection, alarm, and response systems to enable rapid identification and response to developing incidents.",
    ],
    keywords: [
      "fire detection",
      "gas detection",
      "F&G",
      "ESD",
      "emergency shutdown",
      "SIS",
      "safety instrumented",
      "SIL",
      "alarm",
      "response",
    ],
    type: "detective",
    category: "automated",
    owners: {
      primary: ["Instrumentation Manager", "Process Safety Manager", "Operations Manager"],
      secondary: ["Control Systems Engineer", "Safety Advisor", "Maintenance Manager"],
    },
    frequency: "continuous",
    department: "operations",
    mitigatesRiskCategories: ["process-safety", "fire-explosion", "emergency-response"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.environmental = [
  {
    id: "ctrl-spill-prevention",
    titles: [
      "Spill Prevention Program",
      "SPCC Plan",
      "Secondary Containment",
      "Spill Prevention Control and Countermeasure",
      "Oil Pollution Prevention",
      "Tank Integrity Program",
      "Overfill Prevention",
      "Transfer Procedures",
    ],
    descriptions: [
      "Comprehensive spill prevention program including secondary containment, tank integrity management, transfer procedures, and inspection programs.",
      "SPCC plan meeting EPA requirements with facility diagrams, containment descriptions, and response procedures for oil storage facilities.",
      "Secondary containment systems for tanks, process areas, and transfer points sized and maintained to contain potential releases.",
      "Overfill prevention systems and procedures including high-level alarms, automatic shutoffs, and operator verification during transfers.",
      "Transfer procedures requiring verification, monitoring, and communication protocols to prevent spills during loading and unloading operations.",
    ],
    keywords: [
      "spill prevention",
      "SPCC",
      "secondary containment",
      "overfill",
      "tank integrity",
      "transfer",
      "EPA",
      "oil pollution",
      "containment",
      "inspection",
    ],
    type: "preventive",
    category: "physical",
    owners: {
      primary: ["Environmental Manager", "Operations Manager", "Facility Manager"],
      secondary: ["Environmental Coordinator", "Tank Inspector", "Operations Supervisor"],
    },
    frequency: "continuous",
    department: "environmental",
    mitigatesRiskCategories: ["environmental", "spill-prevention", "regulatory-compliance"],
  },
  {
    id: "ctrl-spill-response",
    titles: [
      "Spill Response Program",
      "Oil Spill Response Plan",
      "OSRP",
      "Spill Response Equipment",
      "Spill Response Organization",
      "OSRO Contract",
      "Spill Drills",
      "Spill Containment",
    ],
    descriptions: [
      "Oil spill response plan detailing notification, assessment, containment, and cleanup procedures for spills of various sizes and locations.",
      "Spill response equipment positioned and maintained for rapid deployment including boom, absorbents, skimmers, and communications equipment.",
      "Contracts with oil spill response organizations (OSROs) providing access to specialized equipment, personnel, and expertise for major spills.",
      "Regular spill response drills testing equipment deployment, personnel response, and coordination with external response organizations.",
      "Tiered response approach with facility response for small spills and escalation to regional and national resources for larger events.",
    ],
    keywords: [
      "spill response",
      "OSRP",
      "containment",
      "cleanup",
      "OSRO",
      "boom",
      "skimmer",
      "drills",
      "equipment",
      "notification",
    ],
    type: "corrective",
    category: "manual",
    owners: {
      primary: ["Environmental Manager", "Emergency Response Coordinator", "Operations Manager"],
      secondary: ["Spill Response Team", "HSE Manager", "Community Relations"],
    },
    frequency: "triggered",
    department: "environmental",
    mitigatesRiskCategories: ["environmental", "spill-response", "emergency-response"],
  },
  {
    id: "ctrl-emissions-management",
    titles: [
      "Emissions Management Program",
      "LDAR Program",
      "Leak Detection and Repair",
      "Methane Reduction",
      "Flare Management",
      "Emissions Monitoring",
      "GHG Reporting",
      "Environmental Monitoring",
    ],
    descriptions: [
      "Comprehensive emissions management program addressing air emissions, methane, and greenhouse gases with monitoring, reduction, and reporting.",
      "Leak detection and repair (LDAR) program using OGI cameras, Method 21, or other approved techniques to identify and repair fugitive emissions.",
      "Flare management program minimizing routine flaring and ensuring flare efficiency for required safety and process flaring.",
      "Continuous emissions monitoring for permitted sources with data management and reporting to regulatory agencies.",
      "Greenhouse gas emissions inventory and reporting under applicable regulations and voluntary frameworks.",
    ],
    keywords: [
      "emissions",
      "LDAR",
      "methane",
      "GHG",
      "flaring",
      "monitoring",
      "reporting",
      "air quality",
      "fugitive emissions",
      "EPA",
    ],
    type: "detective",
    category: "automated",
    owners: {
      primary: ["Environmental Manager", "Sustainability Manager", "Operations Manager"],
      secondary: ["Environmental Engineer", "LDAR Technician", "Regulatory Specialist"],
    },
    frequency: "scheduled",
    department: "environmental",
    mitigatesRiskCategories: ["environmental", "regulatory-compliance", "climate-risk"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.operational = [
  {
    id: "ctrl-production-monitoring",
    titles: [
      "Production Monitoring",
      "Well Surveillance",
      "Production Optimization",
      "SCADA Systems",
      "Real-time Monitoring",
      "Production Dashboard",
      "Remote Operations",
      "Control Room Operations",
    ],
    descriptions: [
      "Real-time production monitoring and surveillance systems enabling early detection of issues and optimization of production from wells and facilities.",
      "Comprehensive well and facility monitoring tracking pressures, temperatures, flows, and equipment status with alarming for abnormal conditions.",
      "Production optimization programs analyzing well and facility performance to identify opportunities for increased production and efficiency.",
      "SCADA systems providing remote monitoring and control of dispersed production assets with centralized operations centers.",
      "Control room operations with trained operators monitoring multiple facilities and coordinating field responses.",
    ],
    keywords: [
      "production",
      "monitoring",
      "surveillance",
      "SCADA",
      "optimization",
      "real-time",
      "dashboard",
      "control room",
      "remote operations",
      "alarming",
    ],
    type: "detective",
    category: "automated",
    owners: {
      primary: ["Production Manager", "Operations Superintendent", "Control Room Manager"],
      secondary: ["Production Engineer", "Control Room Operator", "Field Supervisor"],
    },
    frequency: "continuous",
    department: "production",
    mitigatesRiskCategories: ["production-performance", "operations", "reliability"],
  },
  {
    id: "ctrl-maintenance-program",
    titles: [
      "Maintenance Program",
      "Preventive Maintenance",
      "Predictive Maintenance",
      "Reliability Program",
      "Equipment Maintenance",
      "CMMS",
      "Work Order Management",
      "Maintenance Planning",
    ],
    descriptions: [
      "Comprehensive maintenance program including preventive, predictive, and corrective maintenance activities to ensure equipment reliability.",
      "Preventive maintenance schedules based on manufacturer recommendations, operating experience, and criticality analysis.",
      "Predictive maintenance using condition monitoring, vibration analysis, thermography, and oil analysis to detect developing failures.",
      "Computerized maintenance management system (CMMS) for work order management, maintenance history, and performance tracking.",
      "Maintenance planning and scheduling ensuring resources are available and maintenance is completed efficiently.",
    ],
    keywords: [
      "maintenance",
      "preventive",
      "predictive",
      "reliability",
      "CMMS",
      "work order",
      "scheduling",
      "planning",
      "condition monitoring",
      "equipment",
    ],
    type: "preventive",
    category: "manual",
    owners: {
      primary: ["Maintenance Manager", "Reliability Engineer", "Operations Manager"],
      secondary: ["Maintenance Planner", "Maintenance Supervisor", "Technician"],
    },
    frequency: "scheduled",
    department: "maintenance",
    mitigatesRiskCategories: ["reliability", "production-performance", "asset-integrity"],
  },
  {
    id: "ctrl-pipeline-integrity",
    titles: [
      "Pipeline Integrity Management",
      "ILI Program",
      "Inline Inspection",
      "Corrosion Management",
      "Pipeline Inspection",
      "Leak Detection System",
      "CP System",
      "Cathodic Protection",
    ],
    descriptions: [
      "Pipeline integrity management system per API 1160 and 49 CFR 195 including threat identification, risk assessment, inspection, and remediation.",
      "Inline inspection (smart pigging) program using magnetic flux leakage, ultrasonic, and geometry tools to identify anomalies.",
      "Corrosion management including cathodic protection, coatings, chemical treatment, and monitoring for internal and external corrosion.",
      "Computational pipeline monitoring and leak detection systems providing continuous monitoring for abnormal flow conditions.",
      "Integrity digs and repairs based on inspection findings with prioritization based on severity and criticality.",
    ],
    keywords: [
      "pipeline",
      "integrity",
      "ILI",
      "corrosion",
      "inspection",
      "leak detection",
      "cathodic protection",
      "smart pig",
      "API 1160",
      "PHMSA",
    ],
    type: "detective",
    category: "automated",
    owners: {
      primary: ["Pipeline Manager", "Integrity Manager", "Corrosion Engineer"],
      secondary: ["Pipeline Engineer", "Integrity Engineer", "Inspector"],
    },
    frequency: "scheduled",
    department: "pipeline",
    mitigatesRiskCategories: ["pipeline-integrity", "environmental", "operations"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.cyber = [
  {
    id: "ctrl-ot-security",
    titles: [
      "OT Security Program",
      "Industrial Cybersecurity",
      "ICS Security",
      "SCADA Security",
      "Control System Security",
      "Network Segmentation",
      "OT Monitoring",
      "ICS Defense",
    ],
    descriptions: [
      "Cybersecurity program specifically addressing operational technology and industrial control systems aligned with NIST CSF and IEC 62443.",
      "Network segmentation isolating OT networks from IT networks and the internet with controlled interfaces and monitoring.",
      "OT security monitoring providing visibility into control system traffic and activities to detect anomalies and potential intrusions.",
      "Access control for OT systems including multi-factor authentication, privileged access management, and vendor access controls.",
      "Vulnerability management for OT systems including assessment, prioritization, and patching within operational constraints.",
    ],
    keywords: [
      "OT security",
      "ICS",
      "SCADA",
      "cyber",
      "network segmentation",
      "monitoring",
      "access control",
      "NIST",
      "IEC 62443",
      "vulnerability",
    ],
    type: "preventive",
    category: "automated",
    owners: {
      primary: ["OT Security Manager", "CISO", "IT Director"],
      secondary: ["Control Systems Engineer", "Automation Manager", "IT Security"],
    },
    frequency: "continuous",
    department: "it",
    mitigatesRiskCategories: ["cyber-risk", "operations", "process-safety"],
  },
  {
    id: "ctrl-cyber-incident-response",
    titles: [
      "Cyber Incident Response",
      "OT Incident Response",
      "Cyber Recovery",
      "ICS Incident Management",
      "Cyber Drills",
      "Backup and Recovery",
      "Cyber Crisis Management",
      "Forensics Capability",
    ],
    descriptions: [
      "Cyber incident response plan specific to OT environments including detection, containment, eradication, and recovery procedures.",
      "Offline backups of critical control system configurations, programs, and data enabling recovery from ransomware or destructive attacks.",
      "Regular cyber incident response drills testing detection, response, and recovery capabilities for OT-specific scenarios.",
      "Integration with enterprise crisis management for coordinated response to major cyber events affecting operations.",
      "Forensics capability to investigate cyber incidents and preserve evidence for potential law enforcement involvement.",
    ],
    keywords: [
      "incident response",
      "cyber",
      "recovery",
      "backup",
      "drills",
      "forensics",
      "ransomware",
      "crisis management",
      "OT",
      "containment",
    ],
    type: "corrective",
    category: "policy",
    owners: {
      primary: ["CISO", "OT Security Manager", "IT Director"],
      secondary: ["Incident Response Team", "Operations Manager", "Legal"],
    },
    frequency: "triggered",
    department: "it",
    mitigatesRiskCategories: ["cyber-risk", "business-continuity", "operations"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.regulatory = [
  {
    id: "ctrl-compliance-management",
    titles: [
      "Compliance Management System",
      "Regulatory Compliance Program",
      "Compliance Tracking",
      "Regulatory Reporting",
      "Permit Management",
      "Compliance Calendar",
      "Regulatory Audit Program",
      "Compliance Assurance",
    ],
    descriptions: [
      "Comprehensive compliance management system tracking regulatory requirements, permits, deadlines, and responsible parties across all operations.",
      "Regulatory reporting program ensuring accurate and timely submission of required reports to federal, state, and local agencies.",
      "Permit management including tracking of permit conditions, renewal deadlines, and modification requirements.",
      "Compliance calendar with automated reminders for reporting deadlines, permit renewals, and required inspections.",
      "Internal compliance audits verifying adherence to regulatory requirements and identifying gaps before regulatory inspections.",
    ],
    keywords: [
      "compliance",
      "regulatory",
      "permit",
      "reporting",
      "tracking",
      "audit",
      "calendar",
      "deadline",
      "EPA",
      "BSEE",
    ],
    type: "preventive",
    category: "policy",
    owners: {
      primary: ["Regulatory Affairs Manager", "Compliance Manager", "General Counsel"],
      secondary: ["Environmental Manager", "HSE Manager", "Operations Manager"],
    },
    frequency: "continuous",
    department: "legal",
    mitigatesRiskCategories: ["regulatory-compliance", "environmental", "personal-safety"],
  },
  {
    id: "ctrl-regulatory-engagement",
    titles: [
      "Regulatory Engagement",
      "Agency Relations",
      "Regulatory Affairs",
      "Pre-Application Meetings",
      "Regulatory Stakeholder Management",
      "Industry Association Participation",
      "Regulatory Intelligence",
      "Policy Monitoring",
    ],
    descriptions: [
      "Proactive engagement with regulatory agencies building relationships and understanding of regulatory expectations and concerns.",
      "Pre-application meetings with agencies to discuss proposed activities, identify potential issues, and align on permit requirements.",
      "Participation in industry associations and regulatory forums to stay current on regulatory developments and provide industry perspective.",
      "Regulatory intelligence program monitoring proposed regulations, guidance, and enforcement trends affecting operations.",
      "Stakeholder management for permitting processes including community engagement and response to public comments.",
    ],
    keywords: [
      "regulatory engagement",
      "agency relations",
      "permitting",
      "pre-application",
      "stakeholder",
      "industry association",
      "intelligence",
      "policy",
    ],
    type: "preventive",
    category: "manual",
    owners: {
      primary: ["Regulatory Affairs Manager", "General Counsel", "VP External Affairs"],
      secondary: ["Environmental Manager", "Permitting Manager", "Community Relations"],
    },
    frequency: "continuous",
    department: "legal",
    mitigatesRiskCategories: ["regulatory-compliance", "permitting", "stakeholder-relations"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.emergency = [
  {
    id: "ctrl-emergency-response",
    titles: [
      "Emergency Response Program",
      "Emergency Action Plan",
      "Crisis Management",
      "Incident Command System",
      "ICS",
      "Emergency Response Team",
      "Emergency Drills",
      "Mutual Aid",
    ],
    descriptions: [
      "Comprehensive emergency response program covering fire, explosion, spill, medical, weather, and security emergencies with defined response procedures.",
      "Incident command system (ICS) providing scalable response structure for incidents of varying size and complexity.",
      "Trained emergency response teams at each facility with regular training, drills, and competency verification.",
      "Crisis management program for escalation of major incidents requiring corporate response and external communications.",
      "Mutual aid agreements with neighboring facilities and external response organizations for large-scale emergencies.",
    ],
    keywords: [
      "emergency response",
      "crisis management",
      "ICS",
      "incident command",
      "drills",
      "mutual aid",
      "ERT",
      "evacuation",
      "response team",
    ],
    type: "corrective",
    category: "policy",
    owners: {
      primary: ["Emergency Response Coordinator", "HSE Manager", "Operations Manager"],
      secondary: ["ERT Leader", "Fire Chief", "Security Manager"],
    },
    frequency: "triggered",
    department: "hse",
    mitigatesRiskCategories: ["emergency-response", "process-safety", "personal-safety"],
  },
  {
    id: "ctrl-business-continuity",
    titles: [
      "Business Continuity Plan",
      "BCP",
      "Disaster Recovery",
      "Operational Continuity",
      "Crisis Recovery",
      "Alternate Operations",
      "Continuity Planning",
      "Resilience Program",
    ],
    descriptions: [
      "Business continuity planning ensuring critical operations can continue or rapidly recover following major disruptions.",
      "Disaster recovery planning for IT and OT systems enabling restoration of critical systems within defined recovery time objectives.",
      "Alternate operations planning identifying backup capabilities, alternate sites, and workarounds for extended outages.",
      "Regular business continuity exercises testing plans and identifying gaps in recovery capabilities.",
      "Supply chain continuity planning identifying critical suppliers and alternate sources for extended disruptions.",
    ],
    keywords: [
      "business continuity",
      "disaster recovery",
      "BCP",
      "resilience",
      "recovery",
      "alternate operations",
      "RTO",
      "RPO",
      "continuity planning",
    ],
    type: "corrective",
    category: "policy",
    owners: {
      primary: ["Business Continuity Manager", "Operations Manager", "IT Director"],
      secondary: ["Risk Manager", "Supply Chain Manager", "HR Manager"],
    },
    frequency: "triggered",
    department: "operations",
    mitigatesRiskCategories: ["business-continuity", "operations", "strategic"],
  },
];

window.ERM_TEMPLATES.oilGas.controls.getAll = function () {
  var all = [];
  var categories = ["wellControl", "processSafety", "environmental", "operational", "cyber", "regulatory", "emergency"];
  for (var i = 0; i < categories.length; i++) {
    var cat = this[categories[i]];
    if (cat && Array.isArray(cat)) {
      for (var j = 0; j < cat.length; j++) {
        cat[j].controlCategory = categories[i];
        all.push(cat[j]);
      }
    }
  }
  return all;
};

window.ERM_TEMPLATES.oilGas.controls.findById = function (id) {
  var all = this.getAll();
  for (var i = 0; i < all.length; i++) {
    if (all[i].id === id) return all[i];
  }
  return null;
};

window.ERM_TEMPLATES.oilGas.controls.search = function (keyword) {
  var results = [];
  var lowerKeyword = keyword.toLowerCase();
  var all = this.getAll();
  for (var i = 0; i < all.length; i++) {
    var control = all[i];
    var found = false;
    for (var j = 0; j < control.titles.length; j++) {
      if (control.titles[j].toLowerCase().indexOf(lowerKeyword) !== -1) { found = true; break; }
    }
    if (!found && control.keywords) {
      for (var k = 0; k < control.keywords.length; k++) {
        if (control.keywords[k].toLowerCase().indexOf(lowerKeyword) !== -1) { found = true; break; }
      }
    }
    if (found) results.push(control);
  }
  return results;
};

console.log("Oil & Gas Control Templates loaded - " + window.ERM_TEMPLATES.oilGas.controls.getAll().length + " controls available");
